window.defaultStatus="";var result,sq,ma,md,dr,p3,p5,sugar,exted,err,outhead,recno,badseq,seqby,sugarA=99.109,sugarM=99.0446,S="<A HREF='javascript:opener.SetSeq(\"",V="\")'>",Z="</A>",maA="average mass",maM="monoisotopic mass",posneg0="negative mode",posneg2="positive mode",outrec=[],bases="CUTAG^:#\xb0~)\\JB=/\"+*`',|{[]>?%$!123456789DEFIKLMOPQRSVWXYZN",rnamodslink="http://rna.rega.kuleuven.be/rnamods/";function posB(s){return bases.indexOf(s)}function mytrans(s){return unescape(s)}var mAX=Array(7);mAX[1]=1.00794,mAX[2]=18.015,mAX[3]=79.98,mAX[4]=80.09,mAX[5]=15.999,mAX[6]=22.9898,mAX[7]=39.0983;var mMX=Array(7);mMX[1]=1.00782,mMX[2]=18.01,mMX[3]=79.966,mMX[4]=80.0262,mMX[5]=15.995,mMX[6]=22.9898,mMX[7]=38.9637;var mAB=Array(bases.length);mAB[posB("C")]=110.096,mAB[posB("U")]=111.081,mAB[posB("T")]=125.108,mAB[posB("A")]=134.121,mAB[posB("G")]=150.121,mAB[posB(":")]=mAB[posB("A")],mAB[posB("^")]=mAB[posB("A")],mAB[posB("P")]=mAB[posB("U")],mAB[posB("=")]=148.15,mAB[posB("/")]=mAB[posB("=")],mAB[posB('"')]=mAB[posB("=")],mAB[posB("+")]=202.24,mAB[posB("*")]=248.33,mAB[posB("`")]=218.24,mAB[posB("6")]=279.24,mAB[posB("[")]=325.33,mAB[posB("E")]=293.26,mAB[posB("S")]=170.22,mAB[posB("K")]=164.15,mAB[posB("L")]=mAB[posB("K")],mAB[posB("7")]=mAB[posB("K")],mAB[posB("#")]=mAB[posB("G")],mAB[posB("R")]=178.17,mAB[posB("|")]=mAB[posB("R")],mAB[posB("W")]=407.36,mAB[posB("Y")]=375.36,mAB[posB("'")]=124.12,mAB[posB("?")]=mAB[posB("'")],mAB[posB("B")]=mAB[posB("C")],mAB[posB("%")]=126.16,mAB[posB("M")]=152.13,mAB[posB(">")]=138.11,mAB[posB("\xb0")]=mAB[posB(">")],mAB[posB("I")]=135.11,mAB[posB("O")]=149.13,mAB[posB("Q")]=276.28,mAB[posB("9")]=438.42,mAB[posB("8")]=mAB[posB("9")],mAB[posB("D")]=113.1,mAB[posB("2")]=127.15,mAB[posB("4")]=mAB[posB("2")],mAB[posB("F")]=141.17,mAB[posB("X")]=212.19,mAB[posB("5")]=141.11,mAB[posB("V")]=185.12,mAB[posB(",")]=199.14,mAB[posB("1")]=183.14,mAB[posB("3")]=199.21,mAB[posB("{")]=154.15,mAB[posB("~")]=168.13,mAB[posB(")")]=198.16,mAB[posB("!")]=mAB[posB(")")],mAB[posB("$")]=214.22,mAB[posB("J")]=mAB[posB("U")],mAB[posB("\\")]=mAB[posB("T")],mAB[posB("]")]=mAB[posB("T")],mAB[posB("Z")]=mAB[posB("J")],mAB[posB("N")]=0;var mMB=Array(bases.length);mMB[posB("C")]=110.0354,mMB[posB("U")]=111.0194,mMB[posB("T")]=125.0351,mMB[posB("A")]=134.0467,mMB[posB("G")]=150.0416,mMB[posB(":")]=mMB[posB("A")],mMB[posB("^")]=mMB[posB("A")],mMB[posB("P")]=mMB[posB("U")],mMB[posB("=")]=148.0623,mMB[posB("/")]=mMB[posB("=")],mMB[posB('"')]=mMB[posB("=")],mMB[posB("+")]=202.1093,mMB[posB("*")]=248.097,mMB[posB("`")]=218.1042,mMB[posB("6")]=279.0842,mMB[posB("[")]=325.0719,mMB[posB("E")]=393.0998,mMB[posB("S")]=170.0388,mMB[posB("K")]=164.0572,mMB[posB("L")]=mMB[posB("K")],mMB[posB("7")]=mMB[posB("K")],mMB[posB("#")]=mMB[posB("G")],mMB[posB("R")]=178.0729,mMB[posB("|")]=mMB[posB("R")],mMB[posB("W")]=407.1315,mMB[posB("Y")]=375.1417,mMB[posB("'")]=124.0511,mMB[posB("?")]=mMB[posB("'")],mMB[posB("B")]=mMB[posB("C")],mMB[posB("%")]=126.0126,mMB[posB("M")]=152.046,mMB[posB(">")]=138.0303,mMB[posB("\xb0")]=mMB[posB(">")],mMB[posB("I")]=135.0307,mMB[posB("O")]=149.0463,mMB[posB("Q")]=276.1097,mMB[posB("9")]=438.1625,mMB[posB("8")]=mMB[posB("9")],mMB[posB("D")]=113.0351,mMB[posB("2")]=126.9966,mMB[posB("4")]=mMB[posB("2")],mMB[posB("F")]=141.0123,mMB[posB("X")]=212.0671,mMB[posB("5")]=141.03,mMB[posB("V")]=185.0198,mMB[posB(",")]=199.0355,mMB[posB("1")]=183.0406,mMB[posB("3")]=199.0177,mMB[posB("{")]=154.0616,mMB[posB("~")]=168.0409,mMB[posB(")")]=198.0515,mMB[posB("!")]=mMB[posB(")")],mMB[posB("$")]=214.0286,mMB[posB("J")]=mMB[posB("U")],mMB[posB("\\")]=mMB[posB("T")],mMB[posB("]")]=mMB[posB("T")],mMB[posB("Z")]=mMB[posB("J")],mMB[posB("N")]=0;var mAS=Array(bases.length);mAS[posB(":")]=14.03,mAS[posB("^")]=mAX[3],mAS[posB("\xb0")]=mAS[posB(":")],mAS[posB("|")]=mAS[posB(":")],mAS[posB("#")]=mAS[posB(":")],mAS[posB("B")]=mAS[posB(":")],mAS[posB("~")]=mAS[posB(":")],mAS[posB(")")]=mAS[posB(":")],mAS[posB("J")]=mAS[posB(":")],mAS[posB("\\")]=mAS[posB(":")],mAS[posB("Z")]=mAS[posB(":")];var mMS=Array(bases.length+1);mMS[posB(":")]=14.0156,mMS[posB("^")]=mMX[3],mMS[posB("\xb0")]=mMS[posB(":")],mMS[posB("|")]=mMS[posB(":")],mMS[posB("#")]=mMS[posB(":")],mMS[posB("B")]=mMS[posB(":")],mMS[posB("~")]=mMS[posB(":")],mMS[posB(")")]=mMS[posB(":")],mMS[posB("J")]=mMS[posB(":")],mMS[posB("\\")]=mMS[posB(":")],mMS[posB("Z")]=mMS[posB(":")];var nMB=Array(bases.length);nMB[posB("C")]=110.0354,nMB[posB("U")]=111.0194,nMB[posB("T")]=125.0351,nMB[posB("A")]=134.0467,nMB[posB("G")]=150.0416,nMB[posB("D")]=nMB[posB("C")],nMB[posB("V")]=nMB[posB("U")],nMB[posB("S")]=nMB[posB("T")],nMB[posB("B")]=nMB[posB("A")],nMB[posB("H")]=nMB[posB("G")];var nAB=Array(bases.length);nAB[posB("C")]=110.096,nAB[posB("U")]=111.081,nAB[posB("T")]=125.108,nAB[posB("A")]=134.121,nAB[posB("G")]=150.121,nMB[posB("D")]=nMB[posB("C")],nMB[posB("V")]=nMB[posB("U")],nMB[posB("S")]=nMB[posB("T")],nMB[posB("B")]=nMB[posB("A")],nMB[posB("H")]=nMB[posB("G")];var nAS=Array(bases.length),nMS=Array(bases.length+1),nAX=Array(7);nAX[1]=1.00794,nAX[2]=18.015,nAX[3]=96.0465,nAX[4]=80.09,nAX[5]=15.999,nAX[6]=22.9898,nAX[7]=39.0983;var nMX=Array(7);nMX[1]=1.00782,nMX[2]=18.01,nMX[3]=95.94348,nMX[4]=80.0262,nMX[5]=15.995,nMX[6]=22.9898,nMX[7]=38.9637;var Bref=Array(bases.length);Bref[posB("C")]="C",Bref[posB("U")]="U",Bref[posB("T")]=52,Bref[posB("A")]="A",Bref[posB("G")]="G",Bref[posB(":")]=4,Bref[posB("^")]=16,Bref[posB("P")]=50,Bref[posB("=")]=3,Bref[posB("/")]=2,Bref[posB('"')]=1,Bref[posB("+")]=6,Bref[posB("*")]=7,Bref[posB("`")]=8,Bref[posB("6")]=11,Bref[posB("[")]=12,Bref[posB("E")]=13,Bref[posB("S")]=73,Bref[posB("K")]=29,Bref[posB("L")]=30,Bref[posB("7")]=31,Bref[posB("#")]=32,Bref[posB("R")]=33,Bref[posB("|")]=35,Bref[posB("W")]=38,Bref[posB("Y")]=37,Bref[posB("'")]=20,Bref[posB("?")]=21,Bref[posB("B")]=22,Bref[posB("%")]=23,Bref[posB("M")]=24,Bref[posB(">")]=25,Bref[posB("\xb0")]=95,Bref[posB("I")]=17,Bref[posB("O")]=18,Bref[posB("Q")]=43,Bref[posB("9")]=45,Bref[posB("8")]=46,Bref[posB("D")]=51,Bref[posB("2")]=57,Bref[posB("4")]=58,Bref[posB("F")]=59,Bref[posB("X")]=61,Bref[posB("5")]=63,Bref[posB("V")]=64,Bref[posB(",")]=67,Bref[posB("1")]=68,Bref[posB("3")]=70,Bref[posB("{")]=72,Bref[posB("~")]=76,Bref[posB(")")]=78,Bref[posB("!")]=77,Bref[posB("$")]=79,Bref[posB("J")]=53,Bref[posB("\\")]=54,Bref[posB("]")]=55,Bref[posB("Z")]=56,Bref[posB("N")]=0;var NN=Array(bases.length);NN[posB("C")]="C",NN[posB("U")]="U",NN[posB("T")]="T",NN[posB("A")]="A",NN[posB("G")]="G",NN[posB(":")]="Am",NN[posB("^")]="Arp",NN[posB("P")]="<FONT FACE='symbol'>Y</FONT>",NN[posB("=")]="m<SUP>6</SUP>A",NN[posB("/")]="m<SUP>2</SUP>A",NN[posB('"')]="m<SUP>1</SUP>A",NN[posB("+")]="i<SUP>6</SUP>A",NN[posB("*")]="ms<SUP>2</SUP>i<SUP>6</SUP>A",NN[posB("`")]="io<SUP>6</SUP>A",NN[posB("6")]="t<SUP>6</SUP>A",NN[posB("[")]="ms<SUP>2</SUP>t<SUP>6</SUP>A",NN[posB("E")]="m<SUP>6</SUP>t<SUP>6</SUP>A",NN[posB("S")]="mnm<SUP>5</SUP>s<SUP>2</SUP>U",NN[posB("K")]="m<SUP>1</SUP>G",NN[posB("L")]="m<SUP>2</SUP>G",NN[posB("7")]="m<SUP>7</SUP>G",NN[posB("#")]="Gm",NN[posB("R")]="m<SUP>2</SUP><SUB>2</SUB>G",NN[posB("|")]="m<SUP>2</SUP><SUB>2</SUB>Gm",NN[posB("W")]="oyW",NN[posB("Y")]="yW",NN[posB("'")]="m<SUP>3</SUP>C",NN[posB("?")]="m<SUP>5</SUP>C",NN[posB("B")]="Cm",NN[posB("%")]="s<SUP>2</SUP>C",NN[posB("M")]="ac<SUP>4</SUP>C",NN[posB(">")]="f<SUP>5</SUP>C",NN[posB("\xb0")]="f<SUP>5</SUP>Cm",NN[posB("I")]="I",NN[posB("O")]="m<SUP>1</SUP>I",NN[posB("Q")]="Q",NN[posB("9")]="galQ",NN[posB("8")]="manQ",NN[posB("D")]="D",NN[posB("2")]="s<SUP>2</SUP>U",NN[posB("4")]="s<SUP>4</SUP>U",NN[posB("F")]="m<SUP>5</SUP>s<SUP>2</SUP>U",NN[posB("X")]="acp<SUP>3</SUP>U",NN[posB("5")]="mo<SUP>5</SUP>U",NN[posB("V")]="cmo<SUP>5</SUP>U",NN[posB(",")]="mchm<SUP>5</SUP>U",NN[posB("1")]="mcm<SUP>5</SUP>U",NN[posB("3")]="mcm<SUP>5</SUP>s<SUP>2</SUP>U",NN[posB("{")]="mnm<SUP>5</SUP>U",NN[posB("~")]="ncm<SUP>5</SUP>Um",NN[posB(")")]="cmnm<SUP>5</SUP>Um",NN[posB("!")]="cmnm<SUP>5</SUP>U",NN[posB("$")]="cmnm<SUP>5</SUP>s<SUP>2</SUP>U",NN[posB("J")]="Um",NN[posB("\\")]="m<SUP>5</SUP>Um",NN[posB("]")]="m<SUP>1</SUP><FONT FACE='symbol'>Y</FONT>",NN[posB("Z")]="<FONT FACE='symbol'>Y</FONT>m",NN[posB("N")]="user defined";var massX=Array(bases.length),massS=Array(bases.length),massB=Array(bases.length),maxlen=Array(8);function SetStatus(s){var e=[];e[1]="enter your sequence here",e[2]="the average mass is the weighed average of all atom isotopes in the molecule",e[3]="the monoisotopic mass is the sum of the masses of the most abundant isotopes in the molecule",e[4]="select the approprate ionization mode",e[5]="this selects the type of the oligonucleotide",e[6]="set the 5' terminal end to OH or to phosphate",e[7]="set the 3' terminal end to OH, phosphate (p) or cyclic phosphate (>p)",e[8]="checking this option will include a 'close' button in the output",e[9]="checking this option will include the current settings in the output",e[10]="this option gives more detailed output",e[11]="warnings and error messages will be disabled if this option is checked",e[12]="checking this option will sort the output by mass",e[13]="select the desired calculation and press 'calculate'; see 'help' for more details",e[14]="select a memory location to store the sequence and press 'store'; use 'restore' to retrieve the entry",e[15]="this determines the output format for a sequence: in groups of 3, 10 or 50 nucleotides",e[16]="enter here the base anion mass",e[17]="enter here the mass to be added to regular ribose (for RNA) or deoxyribose (for DNA)",e[18]="checking this option will also output undercut enzymatic fragments",window.status=e[s]}function HelpMe(){(result=window.open("mongohlp.htm","","resizable=1,menubar=1,scrollbars=1,width=600,height=425")).document.close(),result.focus()}function myalert(s){if(document.forms[0].alertbt.checked){var e=[];e[1]="Please enter a sequence",e[2]="Cannot calculate, sequence too long",e[3]="You have to select a memory location first in order to store and restore sequences",e[4]="Cannot store an empty sequence",e[100]="This enzyme works only on RNA.\nContinue anyway?",e[101]=badseq,s<100?alert(e[s]):confirm(e[s])&&--err,++err}}function storeit(){if(0==document.forms[0].selmem.selectedIndex){myalert(3);return}if(0==document.forms[0].seq.value.length){myalert(4);return}var shortseq=document.forms[0].seq.value.length>15?document.forms[0].seq.value.substring(0,15)+"...":document.forms[0].seq.value;eval("document.forms[0].selmem.options[document.forms[0].selmem.selectedIndex].value = document.forms[0].seq.value"),eval("document.forms[0].selmem.options[document.forms[0].selmem.selectedIndex].text = shortseq")}function restoreit(){if(0==document.forms[0].selmem.selectedIndex){myalert(3);return}document.forms[0].seq.value=eval("document.forms[0].selmem.options[document.forms[0].selmem.selectedIndex].value")}function clearit(){for(var s=1;s<6;++s)document.forms[0].selmem.options[s].value="",document.forms[0].selmem.options[s].text=s+": (empty)"}function RNAmods(s){var e=bases.charAt(s);return s<0&&(e="The RNA Modification Database".link(rnamodslink)),"number"==typeof Bref[s]&&Bref[s]>0&&(e=e.link(rnamodslink+"rnashow.pl?"+("000"+Bref[s]).substring(("000"+Bref[s]).length-3,("000"+Bref[s]).length))),"number"!=typeof Bref[s]&&(e=e.link(rnamodslink+"rnafind.pl?NAM=1&NUC="+bases.charAt(s))),e}function ScanSeq(s){var e,o="",r="";for(e=0,badseq="";e<s.length;++e)posB(r=s.charAt(e))>=0?o+=r:r.length==escape(r).length&&(badseq+="invalid residue: "+r+" position: "+(e+1)+"\n");return badseq.length>0&&(badseq+="Ignore and continue anyway?",myalert(101)),o}function SetSeq(s){var e,o;e="p"==s.substring(0,1)?1:0,document.forms[0].p5[e].click(),o=">p"==s.substring(s.length-2,s.length)?2:"p"==s.substring(s.length-1,s.length)?1:0,document.forms[0].p3[o].click(),document.forms[0].seq.value=s.substring(e,s.length-o),document.forms[0].seq.focus()}function cleanseq(){var s,e,o,r="CTAGU";for(s=0,e=document.forms[0].seq.value,o="";s<e.length;++s)r.indexOf(e.charAt(s).toUpperCase())>=0&&(o+=e.charAt(s).toUpperCase());document.forms[0].seq.value=o}function DNA2RNA(){var s,e,o,r,t="CTAG",B="GAUC";for(s=0,o=document.forms[0].seq.value,r="";s<o.length;++s)(e=t.indexOf(o.charAt(s).toUpperCase()))>=0&&(r+=B.charAt(e));document.forms[0].seq.value=r}function RNA2DNA(){var s,e,o,r,t="CTAG",B="GAUC";for(s=0,o=document.forms[0].seq.value,r="";s<o.length;++s)(e=B.indexOf(o.charAt(s).toUpperCase()))>=0&&(r+=t.charAt(e));document.forms[0].seq.value=r}function CalcSeq(s,e){var o,r,t=e-massX[3]+massX[2];for(o=0;o<s.length;o++)t+=sugar+massB[r=posB(s.charAt(o))]+massX[3],null!=massS[r]&&(t+=massS[r]);return t}function str(s,e,o){var r,t=""+s;if(str.arguments.length>2){var B=t.indexOf(".");if(B<0&&(t+="."),B=t.indexOf("."),o>0){for(r=0;r<o;++r)t+="0";t=t.substring(0,B+o+1)}else t=o<0?t.substring(0,B):t.substring(0,B+1);for(r=t.length;r<e;++r)t=" "+t}else for(r=t.length;r<e;++r)t+=" ";return t}function Calc0(){var s=sq.length-1,e=0;"p"==p5&&(e+=massX[3],++s),"p"==p3&&(e+=massX[3],++s),">p"==p3&&(e+=massX[3]-massX[2],++s);var o=CalcSeq(sq,e);outhead+="M ="+str(o,10,3)+"     [M+H]+ ="+str(o+massX[1],10,3)+"     [M-H]- ="+str(o-massX[1],10,3)}function Calc1(){var s=sq.length-1,e=0;"p"==p5&&(e+=massX[3],++s),"p"==p3&&(e+=massX[3],++s),">p"==p3&&(e+=massX[3]-massX[2],++s);var o=CalcSeq(sq,e);for(outhead+="   ch     m/z",exted&&(outhead+="       M+Na      M+K      M+2Na"),outhead+="\n\n",i=1;i<=s;++i)outhead+=str(md*i,5,-1)+str((o+md*i*massX[1])/i,10,3),exted&&(outhead+=str((o+massX[6]-massX[1]+md*i*massX[1])/i,10,3),outhead+=str((o+massX[7]-massX[1]+md*i*massX[1])/i,10,3),outhead+=str((o+2*massX[6]-2*massX[1]+md*i*massX[1])/i,10,3)),i<s&&(outhead+="\n")}function Calc2(){var s,e,o,r,t,B,m=0,n=0,a=massX[4]+massX[3];"RNA"==dr&&(a+=massX[5]);var p=massX[3];for("p"==p5&&(a+=massX[3],++m),"p"==p3&&(p+=massX[3],++n),">p"==p3&&(p+=massX[3]-massX[2],++n),sorted?outhead+="     m/z     ion  n   ch":(outhead+="    n   ch      a-B        w",exted&&(outhead+="         y       d-H2O")),outhead+="\n",s=1;s<sq.length;++s)for(e=1,o=CalcSeq(sq.substring(sq.length-s,sq.length),p),t=CalcSeq(sq.substring(sq.length-s,sq.length),p-massX[3]),r=CalcSeq(sq.substring(0,s-1),a+(null==massS[posB(sq.charAt(s-1))]?0:massS[posB(sq.charAt(s-1))])),B=CalcSeq(sq.substring(0,s),massX[3]-massX[2]),charge=(1==n||1==m?1:0)+s;e<=charge;++e)sorted?(e<s+m&&s>1&&(outrec[recno]=str((r+md*e*massX[1])/e,10,3),outrec[recno]+=(str("a-"+sq.charAt(s-1),6,-1)+str(s,3,-1)+str("["+md*e+"]",6,-1)).fontcolor("red"),++recno),e<=s+n&&(outrec[recno]=str((o+md*e*massX[1])/e,10,3),outrec[recno]+=str("w",6,-1)+str(s,3,-1)+str("["+md*e+"]",6,-1),++recno),e<=s+n&&exted&&(outrec[recno]=str((t+md*e*massX[1])/e,10,3),outrec[recno]+=(str("y",6,-1)+str(s,3,-1)+str("["+md*e+"]",6,-1)).fontcolor("purple"),++recno),e<=s+m&&exted&&(outrec[recno]=str((B+md*e*massX[1])/e,10,3),outrec[recno]+=(str("d-H2O",6,-1)+str(s,3,-1)+str("["+md*e+"]",6,-1)).fontcolor("maroon"),++recno)):(1==e?outrec[recno]=str(s,5,-1):outrec[recno]="     ",outrec[recno]+=str(md*e,5,-1),e<s+m&&s>1?outrec[recno]+=str((r+md*e*massX[1])/e,10,3).fontcolor("red"):outrec[recno]+="          ",e<=s+n?outrec[recno]+=str((o+md*e*massX[1])/e,10,3):outrec[recno]+="          ",e<=s+n&&exted?outrec[recno]+=str((t+md*e*massX[1])/e,10,3).fontcolor("purple"):outrec[recno]+="          ",e<=s+m&&exted?outrec[recno]+=str((B+md*e*massX[1])/e,10,3).fontcolor("maroon"):outrec[recno]+="          ",++recno)}function Calc3(){var s,e,o,r;if(sorted){var t=1;outhead+="     m/z         pos  ch   seq\n"}else{var t=Math.min(5,sq.length-2);for(outhead+="       pos",s=1;s<=t;++s)outhead+=str(s*md,7,-1)+"   ";outhead+="\n"}for(s=1;s<sq.length;++s)for(e=s+1;e<sq.length;++e){for(o=1,r=CalcSeq(sq.substring(s,e),massX[4]+2*massX[3]+("RNA"==dr?massX[5]:0))+(null==massS[posB(sq.charAt(e))]?0:massS[posB(sq.charAt(e))]);o<=Math.min(e-s,t);++o)sorted?(outrec[recno]=str((r+md*o*massX[1])/o,10,3),outrec[recno]+=str(sq.charAt(s)+(s+1)+":"+sq.charAt(e-1)+e,10,-1)+str("["+md*o+"]",5,-1)+"  ",outrec[recno]+="p"+sq.substring(s,e)+"pf",++recno):(1==o&&(outrec[recno]=str(sq.charAt(s)+(s+1)+":"+sq.charAt(e-1)+e,10,-1)),outrec[recno]+=str((r+md*o*massX[1])/o,10,3));!sorted&&++recno}}function Calc4(){var s,e,o,r=sq.length-1,t=0;"p"==p5&&(t+=massX[3],++r),"p"==p3&&(t+=massX[3],++r),">p"==p3&&(t+=massX[3]-massX[2],++r);var B=CalcSeq(sq,t);for(outhead+=sorted?"     m/z       ion  ch\n":" base   ch     M-B       M-BH\n",s=0;s<bases.length;++s)if((o=sq.indexOf(bases.charAt(s)))>=0)for(e=1;e<=r;++e)sorted?(outrec[recno]=str((B-massB[s]+md*e*massX[1])/e,10,3),outrec[recno]+=(str("M-"+bases.charAt(s),8,-1)+str("["+md*e+"]",6,-1)).fontcolor("red"),outrec[++recno]=str((B-massB[s]-massX[1]+md*e*massX[1])/e,10,3),outrec[recno]+=str("M-"+bases.charAt(s)+"H",8,-1)+str("["+md*e+"]",6,-1),++recno):(1==e?outrec[recno]=str(bases.charAt(s),5,-1):outrec[recno]="     ",outrec[recno]+=str(md*e,5,-1)+str((B-massB[s]+md*e*massX[1])/e,10,3).fontcolor("red"),outrec[recno]+=str((B-massB[s]-massX[1]+md*e*massX[1])/e,10,3),++recno)}function Calc5(){DigestAt("G")}function Calc6(){DigestAt("A")}function Calc7(){DigestAt("TCU")}function Calc8(){var s,e,o,r=0;for(outhead+=sorted?"      mass         pos  sequence\n":"         pos     mass   sequence\n","p"==p3&&(r=massX[3]),">p"==p3&&(r=massX[3]-massX[2]),s=0;s<sq.length;++s)e=0==s&"p"==p5?massX[3]:0,mw=CalcSeq(sq.substring(s,sq.length),r+e),sorted?(outrec[recno]=str(mw,10,3),outrec[recno]+=str(sq.charAt(s)+(s+1)+":"+sq.charAt(sq.length-1)+sq.length,12,-1)+"  "):(outrec[recno]=str(sq.charAt(s)+(s+1)+":"+sq.charAt(sq.length-1)+sq.length,12,-1),outrec[recno]+=str(mw,10,3)+"  "),o="",0==s&"OH"!=p5&&(o+=p5),o+=sq.substring(s,sq.length),"OH"!=p3&&(o+=p3),outrec[recno]+=S+o+V+o+Z,++recno}function Calc9(){var s,e,o,r=0;for(outhead+=sorted?"      mass         pos  sequence\n":"         pos     mass   sequence\n","p"==p5&&(r=massX[3]),s=sq.length-1;s>=0;--s)e=0,s==sq.length-1&"p"==p3&&(e=massX[3]),s==sq.length-1&">p"==p3&&(e=massX[3]-massX[2]),mw=CalcSeq(sq.substring(0,s+1),r+e),sorted?(outrec[recno]=str(mw,10,3),outrec[recno]+=str(sq.charAt(0)+1+":"+sq.charAt(s)+(s+1),12,-1)+"  "):(outrec[recno]=str(sq.charAt(0)+1+":"+sq.charAt(s)+(s+1),12,-1),outrec[recno]+=str(mw,10,3)+"  "),o="","OH"!=p5&&(o+=p5),o+=sq.substring(0,s+1),s==sq.length-1&"OH"!=p3&&(o+=p3),outrec[recno]+=S+o+V+o+Z,++recno}function Calc10(){var i,amass,bmass,smass;for(sorted||(outhead+=" symbol"),outhead+=" base mass sugar mod",exted&&(outhead+="      N         Np       N>p   "),outhead+=sorted?" symbol\n":"\n",i=0;i<bases.length;++i)smass=null==eval(mm+ma+"S["+i+"]")?0:eval(mm+ma+"S["+i+"]"),amass=eval("smass+"+mm+ma+"B["+i+"]+sugar+"+mm+ma+"X[2]+md*m"+ma+"X[1]"),bmass=eval(mm+ma+"B["+i+"]+"+mm+ma+"X[1]+md*m"+ma+"X[1]"),sorted?(outrec[recno]=str(bmass,10,3),outrec[recno]+=0==smass?str(" ",10):str(smass,10,3),exted&&(outrec[recno]+=str(amass,10,3),outrec[recno]+=str(eval("amass+m"+ma+"X[3]"),10,3),outrec[recno]+=str(eval("amass+m"+ma+"X[3]-m"+ma+"X[2]"),10,3)),outrec[recno]+="    "+RNAmods(i)+"   "+NN[i]):(outrec[recno]="    "+RNAmods(i),outrec[recno]+=str(bmass,12,3),outrec[recno]+=0==smass?str(" ",10):str(smass,10,3),exted&&(outrec[recno]+=str(amass,10,3),outrec[recno]+=str(eval("amass+m"+ma+"X[3]"),10,3),outrec[recno]+=str(eval("amass+m"+ma+"X[3]-m"+ma+"X[2]"),10,3)),outrec[recno]+="   "+NN[i]),++recno;outrec[recno]="...\n\nsee also the "+RNAmods(-1),++recno}function DigestAt(s){if("RNA"==dr||(myalert(100),!(err>0))){var e,o,r,t,B,m,n,a=sq,p="",_="",c=0,$=0;outhead+=sorted?"      mass         pos":"         pos      mass",!sorted&exted&&(outhead+="      3'>p"),outhead+="  sequence\n";for(var m=!0;m;){for(r=0;r<a.length;++r)if(!(0>s.indexOf(a.charAt(r)))||!(r<a.length-1)){for(e=0,o=r,B=a.substring(0,o+1),n=!1;e<s.length;++e)B.indexOf(s.charAt(e))<B.length-1&&B.indexOf(s.charAt(e))>=0&&(n=!0);if(!document.forms[0].uncutbt.checked&&n)break;_=o==a.length-1?"":"p",c=$+o<sq.length-1?massX[3]:0,sq==a&&"OH"!=p5?(c+=massX[3],p=p5):p="",$+o==sq.length-1&&"p"==p3&&(c+=massX[3],_="p"),$+o==sq.length-1&&">p"==p3&&(c+=massX[3]-massX[2],_=">p"),t=CalcSeq(B,c),sorted?(pseq=p+B+_,outrec[recno]=str(t,10,3),outrec[recno]+=str(sq.charAt($)+($+1)+":"+sq.charAt(o+$)+(o+$+1),12,-1)+"  ",outrec[recno]+=S+pseq+V+pseq+Z,++recno,exted&&o+$<sq.length-1&&(pseq=p+B+">p",outrec[recno]=str(t-massX[2],10,3),outrec[recno]+=str(sq.charAt($)+($+1)+":"+sq.charAt(o+$)+(o+$+1),12,-1)+"  ",outrec[recno]+=S+pseq+V+pseq+Z,++recno)):(pseq=p+B+_,outrec[recno]=str(sq.charAt($)+($+1)+":"+sq.charAt(o+$)+(o+$+1),12,-1)+str(t,10,3),exted&&(outrec[recno]+=o+$<sq.length-1?str(t-massX[2],10,3):"          "),outrec[recno]+="  "+S+pseq+V+pseq+Z,++recno)}for(r=0;r<a.length&&!(s.indexOf(a.charAt(r))>=0);++r);a=a.substring(r+1,a.length),$+=r+1,m=a.length>0}}}function DoCalc(){var i=0,j=0;if(err=0,""==document.forms[0].seq.value&!document.forms[0].sel[10].selected){myalert(1);return}for(outhead="<HTML><HEAD><TITLE>Mongo Oligo v2.06 Output</TITLE></HEAD>",outhead+="<BODY BGCOLOR='#FFCCCC' TEXT='#000000' LINK='#0000FF' VLINK='#FF00FF'><PRE>",i=0;i<document.forms[0].dr.length;++i)if(document.forms[0].dr[i].checked){dr=document.forms[0].dr[i].value;break}for(i=0;i<document.forms[0].p5.length;++i)if(document.forms[0].p5[i].checked){p5=document.forms[0].p5[i].value;break}for(i=0;i<document.forms[0].p3.length;++i)if(document.forms[0].p3[i].checked){p3=document.forms[0].p3[i].value;break}for(i=0;i<document.forms[0].ma.length;++i)if(document.forms[0].ma[i].checked){ma=document.forms[0].ma[i].value;break}for(i=0;i<document.forms[0].md.length;++i)if(document.forms[0].md[i].checked){md=document.forms[0].md[i].value;break}for(i=0;i<document.forms[0].seqby.length;++i)if(document.forms[0].seqby[i].checked){seqby=parseInt(document.forms[0].seqby[i].value);break}if(sq=ScanSeq(document.forms[0].seq.value.toUpperCase()),!(err>0)){if(sorted=document.forms[0].sortdbt.checked,exted=document.forms[0].extedbt.checked,massX=eval((mm="m")+ma+"X"),massB=eval(mm+ma+"B"),massS=eval(mm+ma+"S"),(i=document.forms[0].bam.value.toUpperCase()).indexOf("=")>=0?massB[posB("N")]=massB[posB(i.substr(1,1))]:massB[posB("N")]=i.length>0?parseFloat(i):0,(i=document.forms[0].sam.value.toUpperCase()).indexOf("=")>=0?massS[posB("N")]=massS[posB(i.substr(1,1))]:massS[posB("N")]=i.length>0?parseFloat(i):0,sugar=eval("sugar"+ma),"RNA"==dr&&(sugar+=massX[5]),document.forms[0].statsbt.checked){for(outhead+="<B>Sequence : \n<FONT COLOR='red'>",i=0;i<sq.length;i+=seqby)outhead+=sq.substring(i,i+seqby)+" ",(j+=seqby)>49&&(outhead+="\n",j=0);outhead+="</FONT></B><HR>",outhead+="<FONT COLOR='green'>5'"+p5+" - "+dr+"["+sq.length+"mer] - 3'"+p3+"\n";var countb=Array(bases.length-1);for(i=0;i<bases.length;++i)countb[i]=0;for(i=0;i<sq.length;++i)(j=posB(sq.charAt(i)))>=0&&++countb[j];for(i=0;i<bases.length;++i)countb[i]>0&&(outhead+=RNAmods(i)+":"+countb[i]+"  ");sq.toUpperCase().indexOf("N")>=0&&(outhead+="\nN (base)      :"+str(massB[posB("N")],10,3),outhead+="\nN (sugar mod) :"+str(massS[posB("N")],10,3)),outhead+="\n"+eval("ma"+ma)+", "+eval("posneg"+(parseInt(md)+1))+"</FONT>\n"}for(i=0;i<document.forms[0].sel.length;++i)if(document.forms[0].sel[i].selected&&document.forms[0].uncutbt.checked&&"567".indexOf(i)>=0){outhead+="<FONT COLOR='green'>undercuts allowed</FONT>\n";break}for((result=window.open("","result","resizable=1,menubar=1,scrollbars=1,width=550,height=350")).opener=self,result.document.clear(),result.document.writeln(outhead),i=0;i<document.forms[0].sel.length;++i)if(document.forms[0].sel[i].selected){if(outhead=document.forms[0].sel[i].value.toUpperCase().bold()+"\n\n",i<10&&sq.length>maxlen[i]){myalert(2);return}for(outrec=[],recno=0,eval("Calc"+i+"()"),result.document.writeln(outhead),sorted&&outrec.sort(),j=0;j<outrec.length;++j)result.document.writeln(outrec[j]);result.document.writeln()}result.document.write("</PRE>"),document.forms[0].closebt.checked&&result.document.write("<FORM><INPUT TYPE='button' VALUE=' Close ' onClick='window.close()'></FORM>"),result.document.write("</BODY></HTML>"),result.document.close(),0==err&&result.focus()}}maxlen[0]=999999,maxlen[1]=300,maxlen[2]=300,maxlen[3]=300,maxlen[4]=300,maxlen[5]=999999,maxlen[6]=999999,maxlen[7]=999999,maxlen[8]=300,maxlen[9]=300,maxlen[10]=0;
